# Data Dictionary

## Text Files
- client\auth.json
    - Stores the generated user credentials, so that it can be loaded into a ```TJSONObject``` when the main form is created.
    - The file is created when the user is first created using the User Creation Wizard (```frmUserWizard```)
    - If the file exists it is read into ```TClient.Credentials``` before connecting and authenticating to a server.
    - The file format is JSON which is easily parsed into an object whose properties can be red.
- client\server-list.json
    - Stores the servers in a JSON format.
    - The data of the file is read and parsed to a ```TJSONObject``` and ```TJSONArray``` to allow the user to connect to saved servers without re-entering the server's host IP and Port.
    - The file is updated / created when a server is added via the ```TServersUI.AddServer``` GUI.
- server\config.json
    - This file contains all the config for the server. It is stored in JSON format.
    - It is read and parsed to a ```TJSONObject``` in runtime when the server instance is created.
    - It has to be shipped with the build as the config is not generated by default.
    - It can be created or updated via the server management GUI.

## Data Structures

### TJSONObject, TJSONArray and custom classes
JSON is the format used to send data between the client and server. Thus to make it easy to process, two data structures are used:
- ```TJSONArray``` an type of array parsed from JSON
- ```TJSONObject``` an type of object parsed from JSON with static properties accessible through a method called ```Get(index: integer)```

Custom objects make it easy to structure data within the program and instanciate multiple variables, components and methods at once.

Here is one of many examples of where ```JSON``` and ```custom objects``` are used in the program.

```pascal
TClientSession = class
  private
    FUID: string;
    FSessionID: string;
    FUsername: string;
    FSocket: TIdIOHandlerSocket;
    FReady: boolean;
    FDeck: TCardDeck;
    FDecks: TJSONArray;
    procedure SetSessionID(const Value: string);
    procedure SetUID(const Value: string);
    procedure SetUsername(const Value: string);
    procedure SetSocket(const Value: TIdIOHandlerSocket);
    procedure SetReady(const Value: boolean);
    procedure SetDeck(const Value: TCardDeck);
    procedure SetDecks(const Value: TJSONArray);
  published
    constructor Create;
    property UID : string read FUID write SetUID;
    property Username : string read FUsername write SetUsername;
    property SessionID : string read FSessionID write SetSessionID;
    property Socket : TIdIOHandlerSocket read FSocket write SetSocket;
    property Ready: boolean read FReady write SetReady;
    property Deck : TCardDeck read FDeck write SetDeck;
    property Decks : TJSONArray read FDecks write SetDecks;
    procedure LoadDeck(index: integer);
  end;
```

Another example is the server config which is loaded into an object defined below.

This makes it easy to access all the individual variables from one single data structure
```pascal
TServerConfig = class
  private
    FChatFormat: TChatFormat;
    FWhitelist: boolean;
    FListing: TJSONObject;
    FPort: integer;
    FMaxPlayers: integer;
    FAuthServer: TJSONObject;
    FAPIURL: string;
    FUID: string;
    procedure SetChatFormat(const Value: TChatFormat);
    procedure SetListing(const Value: TJSONObject);
    procedure SetMaxPlayers(const Value: integer);
    procedure SetPort(const Value: integer);
    procedure SetWhitelist(const Value: boolean);
    procedure SetAuthServer(const Value: TJSONObject);
    procedure SetAPIURL(const Value: string);
    procedure SetUID(const Value: string);
  published
    constructor Create;
    property ChatFormat : TChatFormat read FChatFormat write SetChatFormat;
    property Port : integer read FPort write SetPort;
    property MaxPlayers : integer read FMaxPlayers write SetMaxPlayers;
    property Whitelist : boolean read FWhitelist write SetWhitelist;
    property Listing : TJSONObject read FListing write SetListing;
    property AuthServer : TJSONObject read FAuthServer write SetAuthServer;
    property APIURL : string read FAPIURL write SetAPIURL;
    property UID : string read FUID write SetUID;
    procedure LoadFromFile (APath : string);
  end;
```